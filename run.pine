#!/bin/sh
source functions.pine

## prepare
printc "preparing..."
./prepare.pine

## init the repo
printc "initializing the repo..."
./repo.pine

## the tree of files
printc "growing the tree..."
./make.pine

## update image from github
printc "building image..."
printc $TRAVIS_COMMIT_MESSAGE
( [ ! $(echo "$TRAVIS_COMMIT_MESSAGE" | grep "scratch-build") ]  \
    && ./build-update.pine ) \
    || ./init/build.pine
